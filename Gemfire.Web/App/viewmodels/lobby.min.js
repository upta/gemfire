define(["require","exports","durandal/app","auth","hubs/lobby"],function(n,t,i,r,u){function l(){h()}function a(n){return!Boolean(_.find(n.userList(),function(n){return n.id===s.user.userId}))}function v(n){return Boolean(_.find(n.userList(),function(t){return t.id===s.user.userId&&t.id!==n.creator}))}function y(n){return n.creator===s.user.userId}function p(n){f.joinGame(n.id)}function w(n){f.leaveGame(n.id)}var o=i,s=r,f=u,e=ko.observableArray(),c=ko.observable(),h;o.on(f.Triggers.gameCreated,function(n){n.userList=ko.observableArray(n.players),e.push(n)});o.on(f.Triggers.gameRemoved,function(n){var t=_.find(e(),function(t){return t.id==n});e.remove(t)});o.on(f.Triggers.joinedGame,function(n,t){var i=_.find(e(),function(t){return n==t.id});i.userList.push(t)});o.on(f.Triggers.leftGame,function(n,t){var i=_.find(e(),function(t){return n==t.id}),r=_.find(i.userList(),function(n){return n.id==t});i.userList.remove(r)});h=_.once(function(){f.getGames().done(function(n){_.each(n,function(n){n.userList=ko.observableArray(n.players),e.push(n)})})}),t.activate=l,t.filter=c,t.filteredGames=ko.computed(function(){var n=e();return _.sortBy(n,function(n){return n.createdAt}).reverse()}),t.canJoinGame=a,t.canLeaveGame=v,t.createdGame=y,t.joinGame=p,t.leaveGame=w})